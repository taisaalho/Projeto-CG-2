<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>Project</title>
		<style>
			body { margin: 0; }
		</style>
	</head>
	<body>
		
		<script type="module">
            import * as THREE from "./libs/three.module.js"
            import * as CONTROLS from "./libs/OrbitControls.js"

            let controls,renderer, camera, scene
            let animacao1 = false
            let animacao2 = false
            let animacao3 = false
            let animacao4 = false
            let animacao5 = false
            let animacao6 = false
            let animacao7 = false
            let robo, bracoDir, bracoEsq, pernaEsq, pernaDir
            let cabeca, chapeu, olhoDir, olhoEsq, boca, bocaM, bocaG
            let chapeuG, chapeuM, cabecaM, cabecaG
            let pernaG, pernaM, tronco, troncoM, troncoG
            let bracoG, bracoM
            let olhosG, olhosM
            let R1G, R1M, R1
            let R2G, R2M, R2
            let R3G, R3M, R3, R4
            let R5G, R5M, R5
            window.onload=init()

            //Iniciar animação com a tecla k
            document.onkeydown = function(w) {
                if(w.key == 'w' || w.key == 'W'){
                    animacao1 = true;
                }   
            }

            function movement(){
                //Andar em Z
                if(animacao1){
                    robo.position.z += .07;

                    bracoDir.rotation.x = -Math.cos(Date.now() * 0.005) * 0.5;
                    pernaEsq.rotation.x = -Math.cos(Date.now() * 0.005) * 0.5;

                    bracoEsq.rotation.x = Math.cos(Date.now() * 0.005) * 0.5;
                    pernaDir.rotation.x = Math.cos(Date.now() * 0.005) * 0.5;

                    if (robo.position.z >= 7) animacao1 = false, animacao2 = true
                }

                //Transformar
                if(animacao2){
                    robo.rotation.x += .05 
                    robo.position.y -= .05
                    cabeca.position.y -= .02
                    chapeu.position.y -= .02
                    olhoDir.position.y -= .02
                    olhoEsq.position.y -= .02
                    boca.position.y -= .02


                    if (robo.rotation.x >= Math.PI / 2 && robo.position.y <= 2 ) animacao2 = false,animacao3 = true
                }

                //Rolar
                if(animacao3){
                    robo.position.z += .15;


                    bracoDir.rotation.x += .3;
                    bracoEsq.rotation.x += .3;
                    pernaDir.rotation.x += .3;
                    pernaEsq.rotation.x += .3;

                    if(robo.position.z >= 30) animacao3 = false, animacao4 = true
                    
                }

                //Voltar ao normal
                if(animacao4){
                    robo.rotation.x -= .05
                    robo.position.y += .05

                    chapeu.position.y += .02;
                    cabeca.position.y += .02;
                    olhoDir.position.y += .02;
                    olhoEsq.position.y += .02;
                    boca.position.y += .02;

                    if (robo.rotation.x >= -  Math.PI / 2 && robo.position.y >= 0) animacao4 = false, animacao5 = true
                }

                //Rodar
                if (animacao5){
                    robo.rotation.y += .05

                    if (robo.rotation.y >=  Math.PI / 2) animacao5 = false, animacao6 = true
                    
                }

                //Andar em z
                if (animacao6){
                    robo.position.x += .07;

                    bracoDir.rotation.x = -Math.cos(Date.now() * 0.005) * 0.5;
                    pernaEsq.rotation.x = -Math.cos(Date.now() * 0.005) * 0.5;

                    bracoEsq.rotation.x = Math.cos(Date.now() * 0.005) * 0.5;
                    pernaDir.rotation.x = Math.cos(Date.now() * 0.005) * 0.5;

                    if(robo.position.x >= 10) animacao6 = false, animacao7 = true
                }

                //Rodar e parar
                if (animacao7){
                    robo.rotation.y -= .05

                    if (robo.rotation.y <=  -Math.PI / 10) animacao7 = false;
                }
            }
            function init(){

                scene = new THREE.Scene();
                camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
                
                renderer = new THREE.WebGLRenderer();
                renderer.setSize( window.innerWidth, window.innerHeight );
                document.body.appendChild( renderer.domElement );
                
                controls = new CONTROLS.OrbitControls(camera,renderer.domElement)
                
                //R das costas
                R1G = new THREE.BoxGeometry (0.1,1,0.1);
                R1M = new THREE.MeshBasicMaterial( { color: 0x000000 } );
                R1 = new THREE.Mesh( R1G, R1M );
                R1.position.set(-0.2,0,-0.5);
                
                
                
                R2G = new THREE.BoxGeometry (0.5,0.1,0.1);
                R2M = new THREE.MeshBasicMaterial( { color: 0x000000 } );
                R2 = new THREE.Mesh( R2G, R2M );
                R2.position.set(0.1,0.45,-0.5);
            
            
            
                R3G = new THREE.BoxGeometry (0.1,0.5,0.1);
                R3M = new THREE.MeshBasicMaterial( { color: 0x000000 } );
                R3 = new THREE.Mesh( R3G, R3M );
                R3.position.set(0.3,0.25,-0.5);
            
            
            
                R4 = new THREE.Mesh( R2G, R2M );
                R4.position.set(0.1,0,-0.5);
            
            
            
                R5G = new THREE.BoxGeometry(0.7,0.1,0.1)
                R5M = new THREE.MeshBasicMaterial( { color: 0x000000 } );
                R5 = new THREE.Mesh( R5G, R5M )
                R5.rotation.set(Math.PI /1,0,4)
                R5.position.set(0.11,-0.25,-0.5);
                
            
            
            
                //Pernas do Robo
                pernaG = new THREE.BoxGeometry(0.7, 1.3, 0.7);
                pernaM = new THREE.MeshBasicMaterial( { color: 0xffff00 } );
                pernaEsq = new THREE.Mesh( pernaG, pernaM );
                pernaEsq.position.set(-0.39,-1.3,0)
            
            
            

                pernaDir = new THREE.Mesh( pernaG, pernaM )
                pernaDir.position.set(0.39,-1.3,0)
                

            
                //Braço do Robo
                bracoG = new THREE.BoxGeometry(0.7,1.3,1)
                bracoM = new THREE.MeshBasicMaterial( { color: 0xffff00 } );
                bracoDir = new THREE.Mesh( bracoG, bracoM );
                bracoDir.position.set(1.1,0.1,0);
                
            
            
            
            
                bracoEsq = new THREE.Mesh( bracoG, bracoM );
                scene.add( bracoEsq );
                bracoEsq.position.set(-1.1,0.1,0);
                
            
            
                //olhos, boca e chapeu do Robo
                olhosG = new THREE.SphereGeometry (0.12,20,20);
                olhosM = new THREE.MeshBasicMaterial( { color: 0x000000 } );
                olhoEsq = new THREE.Mesh( olhosG, olhosM );
                olhoEsq.position.set(-0.2,1.1,0.23);
                
                
            
                olhoDir = new THREE.Mesh( olhosG, olhosM );
                olhoDir.position.set(0.2,1.1,0.23);
                
            
            
                bocaG = new THREE.BoxGeometry (0.5,0.1,0.1);
                bocaM = new THREE.MeshBasicMaterial( { color: 0x000000 } );
                boca = new THREE.Mesh( bocaG, bocaM );
                boca.position.set(0,0.9,0.4);
            
            
            
                chapeuG = new THREE.CylinderGeometry(0.01,0.3,0.6)
                chapeuM = new THREE.MeshBasicMaterial( { color: 0x964b00    } );
                chapeu = new THREE.Mesh( chapeuG, chapeuM)
                chapeu.position.set(0,1.6,0)
            
            
                //Cabeça do Robo
                cabecaG = new THREE.CylinderGeometry (0.3,0.45,0.6);
                cabecaM = new THREE.MeshBasicMaterial( { color: 0xffff00 } );
                cabeca = new THREE.Mesh( cabecaG, cabecaM );
                cabeca.position.set(0,1,0);
                cabeca.add(olhoDir);
                cabeca.add(olhoEsq);
                cabeca.add(boca);
                cabeca.add(chapeu);


                //Tronco do Robo
                troncoG = new THREE.BoxGeometry( 1.5, 1.5, 1 );
                troncoM = new THREE.MeshBasicMaterial( { color: 0xff0000 } );
                tronco = new THREE.Mesh( troncoG, troncoM );
                tronco.position.set(0,0,0)
                tronco.add(cabeca);
                tronco.add(R1);
                tronco.add(R2);
                tronco.add(R3);
                tronco.add(R4);
                tronco.add(R5);
            
            
                const geometry12 = new THREE.BoxGeometry(70,3,70);
                const material12 = new THREE.MeshBasicMaterial( { color: 0x808080} );
                const cena = new THREE.Mesh( geometry12, material12);
                cena.position.set(0,-3.5,0)
            
            
                //robo.recieveShadow = true;
                
                
                
                camera.position.z = 7;
                
                
                
                
                robo = new THREE.Group();
                robo.add(cabeca, tronco, bracoEsq, bracoDir, pernaDir, pernaEsq, olhoEsq, olhoDir, boca, R1, R2, R3, R4, R5, chapeu)
                scene.add( robo );
                                
                
                
                
                //Animação Robo
                renderer.setAnimationLoop(render)
        }
            function render(){
                renderer.render(scene, camera);
                
                
                movement()
                
                
                controls.update()
            }
            


        
		</script>
	</body>
</html>